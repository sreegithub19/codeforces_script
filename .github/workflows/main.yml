name: Create Kotlin Maven Project

on:
  push:
    branches:
      - main

jobs:
  create-project:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v2

      - name: Set up JDK
        uses: actions/setup-java@v2
        with:
          java-version: '21' # Specify your Java version
          distribution: 'temurin'

      - name: Create Maven Project
        run: |
          mvn archetype:generate -DgroupId=com.example \
                                 -DartifactId=kotlin-hello-world \
                                 -DarchetypeArtifactId=maven-archetype-quickstart \
                                 -DinteractiveMode=false

      - name: Add Kotlin Support
        run: |
          cd kotlin-hello-world
          mvn org.jetbrains.kotlin:kotlin-maven-plugin:1.8.0:compile # Specify the Kotlin version

      - name: Modify pom.xml for Kotlin
        run: |
          cd kotlin-hello-world
          echo '<properties>' >> pom.xml
          echo '    <kotlin.version>1.8.0</kotlin.version>' >> pom.xml
          echo '</properties>' >> pom.xml
          echo '<dependencies>' >> pom.xml
          echo '    <dependency>' >> pom.xml
          echo '        <groupId>org.jetbrains.kotlin</groupId>' >> pom.xml
          echo '        <artifactId>kotlin-stdlib</artifactId>' >> pom.xml
          echo '        <version>1.9.25</version>' >> pom.xml
          echo '    </dependency>' >> pom.xml
          echo '</dependencies>' >> pom.xml
          echo '<build>' >> pom.xml
          echo '    <plugins>' >> pom.xml
          echo '        <plugin>' >> pom.xml
          echo '            <groupId>org.jetbrains.kotlin</groupId>' >> pom.xml
          echo '            <artifactId>kotlin-maven-plugin</artifactId>' >> pom.xml
          echo '            <version>1.9.25</version>' >> pom.xml
          echo '        </plugin>' >> pom.xml
          echo '    </plugins>' >> pom.xml
          echo '</build>' >> pom.xml

      - name: Create Hello World Kotlin File
        run: |
          mkdir -p kotlin-hello-world/src/main/kotlin/com/example
          echo 'package com.example' > kotlin-hello-world/src/main/kotlin/com/example/Main.kt
          echo 'fun main() {' >> kotlin-hello-world/src/main/kotlin/com/example/Main.kt
          echo '    println("Hello, World!")' >> kotlin-hello-world/src/main/kotlin/com/example/Main.kt
          echo '}' >> kotlin-hello-world/src/main/kotlin/com/example/Main.kt

      - name: Commit New Project
        run: |
          git config --global user.name "GitHub Action"
          git config --global user.email "action@github.com"
          git add kotlin-hello-world
          git commit -m "Create Kotlin Hello World project"
          git push
