name: Scala CI

on:
  push:
    branches:
      - scala_
  # pull_request:
  #   branches:
  #     - main

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v3

    - name: Set up JDK 11
      uses: actions/setup-java@v2
      with:
        java-version: '11'
        distribution: 'temurin'
        java-package: 'jdk'
        architecture: 'x64'
        check-latest: false
        overwrite-settings: true
        job-status: 'success'

    - name: Set up Scala
      uses: olafurpg/setup-scala@v12
      with:
        scala-version: '2.13.8'  # The Scala version you want to use

    - name: Cache sbt dependencies
      uses: actions/cache@v3
      with:
        path: ~/.sbt/boot/scala*
        key: ${{ runner.os }}-sbt-${{ hashFiles('**/*.sbt') }}
        restore-keys: |
          ${{ runner.os }}-sbt-

    # - name: Install sbt
    #   run: |
    #           # Download sbt
    #           curl -Lo sbt-1.5.5.tgz https://github.com/sbt/sbt/releases/download/v1.5.5/sbt-1.5.5.tgz
              
    #           # Verify if the file was downloaded
    #           if [ ! -f sbt-1.5.5.tgz ]; then
    #             echo "Failed to download sbt, file does not exist!"
    #             exit 1
    #           fi
              
    #           # Extract the downloaded sbt file
    #           tar xzf sbt-1.5.5.tgz
              
    #           # Move sbt binary to /usr/local/bin
    #           sudo mv sbt /usr/local/bin/
              
    #           # Verify sbt is installed
    #           sbt --version
          

    - name: Run tests with sbt
      run: sbt test  # This will run any tests defined in your project

    - name: Compile and run Scala project
      run: sbt run  # This will run the main method in your Scala project

    - name: Run Scala code using sbt console
      run: |
          sbt -batch "console <<< 'println(\"Hello, Scala from sbt console!\")'"
