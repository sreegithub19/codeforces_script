name: Run Java Code In-Memory

on:
  push:
    branches:
      - js_  # Change this to your target branch
  pull_request:

jobs:
  run-java:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Set up Java
        uses: actions/setup-java@v2
        with:
          java-version: '11'  # Specify the Java version you want to use

      - name: Run Java code
        run: |
          java -Dfile.encoding=UTF-8 -cp . \
          "javax.script.ScriptEngineManager" \
          -e "String code = \"public class Temp { public static void main(String[] args) { System.out.println('Hello from in-memory Java execution!'); }}\"; \
          new javax.tools.ToolProvider.getSystemJavaCompiler().getTask(null, null, null, null, null, java.util.Arrays.asList(new javax.tools.SimpleJavaFileObject(javax.tools.JavaFileObject.Kind.CLASS, null, code)).toList()).call();"
