name: C# Hello World CI

on:
  push:
    branches:
      - c_sharp
  pull_request:

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v2

    - name: Set up .NET
      uses: actions/setup-dotnet@v1
      with:
        dotnet-version: '6.x'  # Specify the .NET version you want

    - name: Create C# Project
      run: |
        dotnet new console -n HelloWorld

    - name: Write Hello World Program
      run: |
          cat <<EOF > HelloWorld/HelloWorld.csproj
          <Project Sdk="Microsoft.NET.Sdk">

            <PropertyGroup>
              <OutputType>Exe</OutputType>
              <TargetFramework>net6.0</TargetFramework>  <!-- You can specify a different version if needed -->
              <StartupObject>HelloWorld.Program</StartupObject>  <!-- Specify the entry point class -->
            </PropertyGroup>

            <ItemGroup>
              <!-- Add any package references here if needed -->
              <!-- <PackageReference Include="SomePackage" Version="1.0.0" /> -->
            </ItemGroup>

          </Project>

          EOF

    - name: Write Hello World Program
      run: |
          cat <<EOF > HelloWorld/Program.cs
          using System;
          
          namespace HelloWorld
          {
              class Program
              {
                  static void Main(string[] args)
                  {
                      Console.WriteLine("Hello, World from Program.cs");
                      first.Main();  // Call the method from FirstProgram
                  }
              }
          }
          EOF

    - name: Write Hello World Program
      run: |
              cat <<EOF > HelloWorld/first.cs
              using System;
              
              namespace HelloWorld
              {
                  class first
                  {
                      static void Main(string[] args)
                      {
                          Console.WriteLine("Hello, World from first.cs");
                      }
                  }
              }
              EOF

    - name: Build the Project
      run: dotnet build HelloWorld/HelloWorld.csproj

    - name: Run the Project
      run: dotnet run --project HelloWorld/HelloWorld.csproj
